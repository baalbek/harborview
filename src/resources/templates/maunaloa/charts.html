<!DOCTYPE html>
<html lang="en">
<head>
    <!--
    <title>Maunaloa - Charts</title>
    -->
    <title>Visual Studio Web Example</title>
    <meta charset="UTF-8">
    {% include "templates/head.html" %}
    <script src="/js/elm/maunaloa/elm-charts.js"></script>
</head>
<body>
    <div class="logo"></div>
    <div class="container">
        <div id="my-app"></div>
    </div>
    <div style="position: absolute; top:200px; left:200px;">
        <canvas id="my-canvas" width="1300" height="600"></canvas>
    </div>
    <!--
    <div id="buttons">
        <input type="button" id="clear" value="Clear">
    </div>
    -->
    <script type="text/javascript">
        var node = document.getElementById('my-app');
        var app = Elm.Maunaloa.Charts.embed(node);
        var drawCanvas = function (chartInfo) {
          var canvas = document.getElementById('my-canvas');
          var ctx = canvas.getContext("2d");
          ctx.clearRect(0,0,canvas.width,canvas.height);
          for (var i = 0; i < chartInfo.lines.length; ++i) {
              ctx.beginPath();
              var curStroke = chartInfo.strokes[i] === undefined ? "#000000" : chartInfo.strokes[i];
              var ys = chartInfo.lines[i];
              drawGraph(ctx,chartInfo.xaxis,ys,curStroke);
          }
          if (chartInfo.candlesticks != null) {
            console.log (chartInfo.candlesticks);
          }
        }
        app.ports.drawCanvas.subscribe(drawCanvas);
        var drawGraph = function (ctx,xs,ys,strokeStyle) {
          if (xs.length !== ys.length) {
            return;
          }
          ctx.lineWidth = 0.5;
          // ctx.setLineDash([5,10]);
          ctx.strokeStyle = strokeStyle; // "#FF0000";
          ctx.moveTo(xs[0],ys[0]);
          for (var i = 1; i < xs.length; ++i) {
            var y = ys[i];
            var x = xs[i];
            ctx.lineTo(x,y);
          }
          ctx.stroke();
        }
    </script>
</body>
</html>
