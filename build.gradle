apply plugin: 'java'

group = 'rcstadheim'
archivesBaseName = 'harborview'
version = '2.0'


ext.springVersion = '4.1.4.RELEASE'
ext.junitVersion = '4.11'
ext.log4jVersion = '1.2.17'
ext.mybatisVersion = '3.2.8'
ext.postgresVersion = '9.1-901.jdbc4'

//-------------------- clojure ---------------------
ext.clojureVersion = '1.6.0'
ext.clojureContribVersion = '1.2.0'
ext.algoMonadsVersion = '0.1.5'
ext.clojuresqueVersion = '1.5.8'
ext.numericTowerVersion = '0.0.2'
ext.jsonVersion = '0.5.3'
ext.ringVersion = '1.3.2'
ext.enliveVersion = '1.1.5'
//ext.enlivenVersion = '0.1.0-SNAPSHOT'
ext.compojureVersion = '1.3.1'

ext.major = '5'
ext.minor = '1'

repositories {
    mavenCentral()
    maven {
        url 'http://clojars.org/repo'
    }
}

dependencies {
    compile project(':stearnswharf-repos')
    compile project(':koteriku')
    compile "compojure:compojure:$compojureVersion"
    compile "enlive:enlive:$enliveVersion"

    //compile "enliven:enliven:$enlivenVersion"
    compile "ring:ring-core:$ringVersion"
    compile "ring:ring-jetty-adapter:$ringVersion"
    compile "ring:ring-servlet:$ringVersion"
    compile "clj-json:clj-json:$jsonVersion"
    compile "org.clojure:clojure:$clojureVersion"
    compile "org.clojure:clojure-contrib:$clojureContribVersion"
    compile "org.clojure:math.numeric-tower:$numericTowerVersion"
    runtime "org.mybatis:mybatis:$mybatisVersion"
    runtime "postgresql:postgresql:$postgresVersion"
    runtime "log4j:log4j:$log4jVersion"
    compile "commons-logging:commons-logging:1.2"
    runtime "jline:jline:0.9.94"
}

task copydeps(type: Copy) {
    into 'dist' from configurations.runtime
}

task setupDist << {
    //ant.symlink(resource: "/usr/local/java/jline-0.9.94.jar", link: "dist/jline-0.9.94.jar")
    ant.symlink(resource: "../src/resources/log4j.xml", link: "dist/log4j.xml")
    ant.symlink(resource: "../src/resources/public", link: "dist/public")
    ant.symlink(resource: "../src/resources/templates", link: "dist/templates")
    ant.symlink(resource: "../src/clojure/harborview", link: "dist/harborview")
    ant.symlink(resource: "../src/resources/dbcp.properties", link: "dist/dbcp.properties")
    ant.symlink(resource: "../src/resources/mybatis.conf.xml", link: "dist/mybatis.conf.xml")
    ant.symlink(resource: "/home/rcs/.gradle/caches/modules-2/files-2.1", link: "libs")
}

buildscript {
    repositories {
        mavenLocal()
    }
    dependencies {
        classpath group: 'rcstadheim', name: 'palenque',
                version: '1.0'
    }
}

apply plugin: 'rcstadheim.palenque'

task winLeinDeps(type: rcstadheim.palenque.LeinDepsTask) {
    useLibsSymlink = false
}

jar {
    from ("target/classes") include "**/*.class"
}
